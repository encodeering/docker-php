--- 5.6/apache/Dockerfile	2016-01-03 22:13:56.687518700 +0000
+++ 5.6/apache/Dockerfile	2016-01-03 22:14:28.941751700 +0000
@@ -36,7 +36,7 @@
 ENV PHP_SHA256 ea9d5749380c7c7171e131616466deacd7cb124b5010eafc34e551b0a7b0fb2c

 # --enable-mysqlnd is included below because it's harder to compile after the fact the extensions are (since it's a plugin for several extensions, not an extension in itself)
-RUN buildDeps=" \
+ENV buildDeps=" \
 		$PHP_EXTRA_BUILD_DEPS \
 		libcurl4-openssl-dev \
 		libreadline6-dev \
@@ -45,8 +45,9 @@
 		libssl-dev \
 		libxml2-dev \
 		xz-utils \
-	" \
-	&& set -x \
+	"
+
+RUN set -x \
 	&& apt-get update && apt-get install -y $buildDeps --no-install-recommends && rm -rf /var/lib/apt/lists/* \
 	&& curl -fSL "http://php.net/get/$PHP_FILENAME/from/this/mirror" -o "$PHP_FILENAME" \
 	&& echo "$PHP_SHA256 *$PHP_FILENAME" | sha256sum -c - \
@@ -66,18 +67,21 @@
 		--with-openssl \
 		--with-readline \
 		--with-recode \
-		--with-zlib \
-	&& make -j"$(nproc)" \
+		--with-zlib
+
+ONBUILD WORKDIR /usr/src/php
+ONBUILD RUN make -j"$(nproc)" \
 	&& make install \
 	&& { find /usr/local/bin /usr/local/sbin -type f -executable -exec strip --strip-all '{}' + || true; } \
 	&& apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false -o APT::AutoRemove::SuggestsImportant=false $buildDeps \
-	&& make clean
+	&& make clean \
+	&& unset buildDeps

 COPY docker-php-ext-* /usr/local/bin/

 ##<autogenerated>##
 COPY apache2-foreground /usr/local/bin/
-WORKDIR /var/www/html
+ONBUILD WORKDIR /var/www/html

 EXPOSE 80
 CMD ["apache2-foreground"]
